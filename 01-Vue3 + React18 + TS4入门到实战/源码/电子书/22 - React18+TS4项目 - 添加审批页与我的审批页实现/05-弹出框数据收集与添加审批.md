# 弹出框数据收集与添加审批

本小节主要完成弹出框数据的收集与添加审批操作，需要给表单的提交按钮添加事件。

```tsx
// /views/Apply/Apply.tsx
export default function Apply() {
    ...
    const onFinish = (values: FormInfos) => {
        values.time[0] = dayjs(values.time[0]).format('YYYY-MM-DD hh:mm:ss')
        values.time[1] = dayjs(values.time[1]).format('YYYY-MM-DD hh:mm:ss')
        const applyList = {
            ...values,
            applicantid: usersInfos._id as string,
            applicantname: usersInfos.name as string,
            approverid: Array.isArray(usersInfos.approver) && usersInfos.approver.find((item)=> item.name === values.approvername)._id
        }
        dispatch(postApplyAction(applyList)).then((action)=>{
            const { errcode } = (
                action.payload as { [index: string]: unknown }
            ).data as { [index: string]: unknown }
            if (errcode === 0) {
                message.success('添加审批成功')
                handleCancel()
                dispatch(getApplyAction({ applicantid: usersInfos._id as string })).then(
                    (action) => {
                        const { errcode, rets } = (
                            action.payload as { [index: string]: unknown }
                        ).data as { [index: string]: unknown }
                        if (errcode === 0) {
                            dispatch(updateApplyList(rets as Infos[]))
                        }
                    }
                )
                dispatch(putRemindAction({ userid: applyList.approverid, approver: true }))
            }
        })
    };
    return (
        <div>
            ...
        	<Button type="primary" htmlType="submit">提交</Button>
        </div>
    )
}
```
